<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.502">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tools for NRM - Learning-by-doing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Tools for NRM</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./Lektion0_1_Lernziele.html" aria-current="page"> 
<span class="menu-text">MFA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./../de"> 
<span class="menu-text">Deutsch</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../en"> 
<span class="menu-text">English</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Lektion1_1_Grundlagen.html">Introduction</a></li><li class="breadcrumb-item"><a href="./Lektion1_2_LBD.html">Learning-by-doing</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion0_1_Lernziele.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning objectives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion0_2_Software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion0_3_FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion1_1_Grundlagen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion1_2_LBD.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Learning-by-doing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion1_3_Workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Mathematical modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion2_1_Bilanzierung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Systems of equations and layers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion2_2_LBD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning-by-doing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lektion2_3_Workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#goal" id="toc-goal" class="nav-link active" data-scroll-target="#goal">Goal</a></li>
  <li><a href="#approach" id="toc-approach" class="nav-link" data-scroll-target="#approach">Approach</a>
  <ul class="collapse">
  <li><a href="#install-stan-open-and-save" id="toc-install-stan-open-and-save" class="nav-link" data-scroll-target="#install-stan-open-and-save">1. Install STAN, open and save</a></li>
  <li><a href="#navigation-and-user-interface" id="toc-navigation-and-user-interface" class="nav-link" data-scroll-target="#navigation-and-user-interface">2. Navigation and user interface</a></li>
  <li><a href="#the-first-process" id="toc-the-first-process" class="nav-link" data-scroll-target="#the-first-process">3. The first process</a></li>
  <li><a href="#further-processes-and-process-with-a-stock" id="toc-further-processes-and-process-with-a-stock" class="nav-link" data-scroll-target="#further-processes-and-process-with-a-stock">4. Further processes and process with a stock</a></li>
  <li><a href="#draw-flows" id="toc-draw-flows" class="nav-link" data-scroll-target="#draw-flows">5. Draw flows</a></li>
  <li><a href="#input-values-for-the-mass-flow-analysis" id="toc-input-values-for-the-mass-flow-analysis" class="nav-link" data-scroll-target="#input-values-for-the-mass-flow-analysis">6. Input values for the mass flow analysis</a></li>
  <li><a href="#transfer-coefficients" id="toc-transfer-coefficients" class="nav-link" data-scroll-target="#transfer-coefficients">7. Transfer coefficients</a></li>
  <li><a href="#system-boundary" id="toc-system-boundary" class="nav-link" data-scroll-target="#system-boundary">8. System boundary</a></li>
  <li><a href="#calculate" id="toc-calculate" class="nav-link" data-scroll-target="#calculate">9. Calculate</a></li>
  <li><a href="#check-system-messages" id="toc-check-system-messages" class="nav-link" data-scroll-target="#check-system-messages">10. Check system messages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Lektion1_1_Grundlagen.html">Introduction</a></li><li class="breadcrumb-item"><a href="./Lektion1_2_LBD.html">Learning-by-doing</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Learning-by-doing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="goal" class="level2">
<h2 class="anchored" data-anchor-id="goal">Goal</h2>
<p>We model the waste management of a municipality with ca. 10,000 inhabitants over the course of a year.</p>
<p>The municipality’s current waste management system consists of municipal waste collection with waste incineration without separate collection of biogenic waste (“biowaste”). Each person produces approx. 700 kg of municipal waste per year. 60% of municipal waste (mass) is biogenic (biodegradable). The municipality already has an anaerobic digestion plant (“biogas plant”), which treats 9,000 tons of green waste (cuttings) and 2,000 tons of farmyard manure from several municipalities. We will first model the current system in STAN step by step (figure).</p>
<p>Then, in the workshop part, we will model options for additional separate collection of municipal biowaste.</p>
<p><img src="images/Lektion_1_2_1.png" class="img-fluid"></p>
</section>
<section id="approach" class="level2">
<h2 class="anchored" data-anchor-id="approach">Approach</h2>
<section id="install-stan-open-and-save" class="level3">
<h3 class="anchored" data-anchor-id="install-stan-open-and-save">1. Install STAN, open and save</h3>
<p>Install STAN, you find further information <a href="./Lektion0_2_Software.html">here</a>.</p>
<p>Open STAN and save the project in a suitable folder. A file with the project extension .zmfa is generated. You should regularly save your project, as STAN does not do this automatically.</p>
</section>
<section id="navigation-and-user-interface" class="level3">
<h3 class="anchored" data-anchor-id="navigation-and-user-interface">2. Navigation and user interface</h3>
<p>Familiarize yourself with the STAN user interface.</p>
<p><img src="images/Lektion_1_2_2.png" class="img-fluid"></p>
<ol type="1">
<li><strong>Menu bar:</strong> Commands for editing and control can be called up in the menu bar.</li>
<li><strong>Toolbar:</strong> The most important commands are displayed graphically.</li>
<li><strong>Model explorer:</strong> Displays processes, flows and subsystems in a tree structure.</li>
<li><strong>Diagram symbols:</strong> The building blocks for creating an MFA, which are selected by clicking with the mouse and then inserted in the drawing area. If you remain with the mouse pointer over the symbols, the symbol type (e.g.&nbsp;process) is displayed.</li>
<li><strong>Drawing area:</strong> The MFA model is created here.</li>
<li><strong>Properties:</strong> In the System properties window, the selected processes, flows and other fields of the MFA are edited and customized. This includes graphical parameters and values.</li>
<li><strong>System messages:</strong> Error messages and information are specified in this window.</li>
</ol>
<p>All windows can be adjusted in size and moved and arranged modularly like tiles.</p>
</section>
<section id="the-first-process" class="level3">
<h3 class="anchored" data-anchor-id="the-first-process">3. The first process</h3>
<p>Now draw the municipal waste collection as the first process (you can also start with any other process). To do this, select the P icon (highlighted in green) in the toolbar and draw a rectangle (“Process 1”).</p>
<p><img src="images/Lektion_1_2_3.png" class="img-fluid"></p>
<p>Name the process “Municipal waste collection”. To do this, select the process and change the name in the Process properties window.</p>
<p><img src="images/Lektion_1_2_4.png" class="img-fluid"></p>
</section>
<section id="further-processes-and-process-with-a-stock" class="level3">
<h3 class="anchored" data-anchor-id="further-processes-and-process-with-a-stock">4. Further processes and process with a stock</h3>
<p>Now expand the MFA with additional processes.</p>
<p>Add the “Waste incineration” and “Ash treatment (fly and bottom ash)” processes to the right of the “Municipal waste collection” process. Below the “Ash treatment (fly and bottom ash)”, add the “Landfill” process.</p>
<p>To the left of the “Municipal waste collection” process, add the “Disposal by households and small businesses” process. We will use this process later to simulate the separation of biowaste and non-biodegradable residual waste. In the status quo model, 100% of the biowaste goes to municipal waste collection.</p>
<p>If necessary, you can move, reduce and increase the size of the processes.</p>
<p>The landfill represents a store that fills up over time. Therefore, select the “Landfill” process and place a checkmark next to Storage in the process properties.</p>
<p><img src="images/Lektion_1_2_5.png" class="img-fluid"></p>
</section>
<section id="draw-flows" class="level3">
<h3 class="anchored" data-anchor-id="draw-flows">5. Draw flows</h3>
<p>Now draw the first flows between the processes.</p>
<p>First, you can draw the import flow “Non-biodegradable waste” from the far left to the process “Disposal by households and small businesses”. The import flow crosses the system boundary, i.e.&nbsp;from processes that are not of interest to us in the question (e.g.&nbsp;consumption of goods) and are outside the system boundary to the first process within the system boundary.</p>
<p><img src="images/Lektion_1_2_6.png" class="img-fluid"></p>
<p>Now connect the processes with flows as shown in the figure below. Flows between processes are not import flows but “normal” flows within the system boundary.</p>
<p><img src="images/Lektion_1_2_7.png" class="img-fluid"></p>
<p>Starting with “Ash treatment (fly and bottom ash)”, you now create “Metal recycling” as the first export flow. This is the recovered metal from ash treatment that is fed into recycling processes. We are not interested in these recycling processes here, as we are dealing with biogenic waste. Therefore, recycling processes for metal are outside the system boundary in this specific case.</p>
<p>Once all flows have been drawn, you can now name all flows using the Flow properties window.</p>
<p>You can also change the color of the flows via the Flow properties window in the “Symbol” tab (see next figure)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Lektion_1_2_7b.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="369"></p>
</figure>
</div>
<p>Now add all processes and flows until your model looks like this.</p>
<p><img src="images/Lektion_1_2_8.png" class="img-fluid"></p>
</section>
<section id="input-values-for-the-mass-flow-analysis" class="level3">
<h3 class="anchored" data-anchor-id="input-values-for-the-mass-flow-analysis">6. Input values for the mass flow analysis</h3>
<p>From the description of the municipality’s waste management, you know, among other things, the amount of biowaste and non-biodegradable waste generated per year. Enter the values in the import flows. Use tons per year (t/a) as the unit.</p>
<p>To do this, click on the import flow to be edited and then click on values in the properties window (green box in the right-hand part of the figure below). This is a mass flow.</p>
<p>The amount of waste (mass) per year is never known exactly. You therefore have the option of entering an uncertainty (+/-). We assume an uncertainty of 20% here, i.e.&nbsp;+/- 10%. We will go into the uncertainty analysis in more detail later.</p>
<p>You can adjust the arrow thickness of the flows in the slider of the sankey diagram (green arrow in the figure below). You can also make all mass flows appear equally thick (“sankey display of flows (on/off)”).</p>
<p><img src="images/Lektion_1_2_9.png" class="img-fluid"></p>
</section>
<section id="transfer-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="transfer-coefficients">7. Transfer coefficients</h3>
<p>A transfer coefficient indicates what proportion of a certain input flow into a process is allocated to an output flow of the same process.</p>
<p>We first enter the transfer coefficients for waste incineration. You can assume that around 10% of the input mass becomes ash and 90% is emitted as smoke/gasses.</p>
<ol type="1">
<li>Select the process “Waste incineration”.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p>Select “Edit process” from the context menu of the process (right-click).</p></li>
<li><p>You can enter the transfer coefficients directly in the individual cells. You can choose between an entry as a number between 0 and 1 (e.g.&nbsp;0,9) or an entry as a percentage (e.g.&nbsp;90%). In our example, enter 0,9 in the direction of “Exhaust gases” and 0.1 in the direction of “Ash”. Decimal values must be separated by a comma or point, depending on your system settings.</p></li>
<li><p>Data uncertainties of the transfer coefficients (as standard deviation of an assumed normal distribution) can be entered directly after the value separated by the character string “+-” (e.g.&nbsp;0,90+-0,045 or 90%+-4,5%)</p></li>
<li><p>Click OK or Apply.</p></li>
</ol>
<p><strong>Transfer coefficients should be entered for all processes. If transfer coefficients are missing in individual processes, this can be a possible reason for error messages.</strong></p>
<p>You can use the following assumptions:</p>
<ul>
<li><p>Waste incineration: 90% of the input mass becomes smoke/gases, 10% becomes ash</p></li>
<li><p>Ash treatment: 90% of the input mass is landfilled, 10% goes to metal recycling</p></li>
<li><p>Anaerobic digestion: 10% of the input mass becomes biogas, 80% becomes digestate and 10% are losses</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Lektion_1_2_10.png" class="img-fluid figure-img"></p>
<figcaption>Transfer coefficients</figcaption>
</figure>
</div>
</section>
<section id="system-boundary" class="level3">
<h3 class="anchored" data-anchor-id="system-boundary">8. System boundary</h3>
<p>Now draw the geographical system boundary. To do this, click on the System boundary icon and position the system boundary so that all starting points of the import and export flows are outside the system boundary and all processes and internal system flows are inside the system boundary.</p>
<p><img src="images/Lektion_1_2_11.png" class="img-fluid"></p>
</section>
<section id="calculate" class="level3">
<h3 class="anchored" data-anchor-id="calculate">9. Calculate</h3>
<p>All the important parameters for calculating the model have now been entered. Click on the calculate icon in the toolbar.</p>
<p><img src="images/Lektion_1_2_12.png" class="img-fluid"></p>
</section>
<section id="check-system-messages" class="level3">
<h3 class="anchored" data-anchor-id="check-system-messages">10. Check system messages</h3>
<p>Check the system messages, which may contain information, warnings and errors. If errors occur, try to correct them based on the error message and then recalculate the model.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Lektion_1_2_13.png" class="img-fluid figure-img"></p>
<figcaption>The system messages shown here are purely informative and do not indicate errors</figcaption>
</figure>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2023, Thomas Gross</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>